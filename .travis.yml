language: node_js

cache:
  directories:
    - node_modules

addons:
  apt:
    sources:
        - ubuntu-toolchain-r-test
    packages:
        - g++-4.8

before_install:
  - export CXX="g++-4.8"

node_js:
    - '4.2'
    - '5.0'

services:
    - docker

before_script:
    - git clone https://${GITHUB_AUTH}:x-oauth-basic@github.com/juttle/juttle.git
    - pushd juttle ; npm install ; npm link ; popd
    - ./scripts/docker.sh start

script:
    - export NODE_PATH="$(dirname `which node`)/../lib/node_modules"
    - npm test

after_script:
    - ./scripts/docker.sh stop
